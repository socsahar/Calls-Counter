    // Export to PDF functionality with Hebrew support using HTML2Canvas
    async exportToPDF() {
        if (!window.html2canvas || !window.jspdf) {
            this.showToast('×©×’×™××” ×‘×˜×¢×™× ×ª ×¡×¤×¨×™×™×ª PDF', 'error');
            return;
        }

        const year = document.getElementById('historyYear').value;
        const month = document.getElementById('historyMonth').value;
        
        if (!this.allCalls || this.allCalls.length === 0) {
            this.showToast('××™×Ÿ × ×ª×•× ×™× ×œ×™×™×¦×•×', 'error');
            return;
        }

        try {
            this.setLoading(true);

            // Month names in Hebrew
            const monthNames = {
                1: '×™× ×•××¨', 2: '×¤×‘×¨×•××¨', 3: '××¨×¥', 4: '××¤×¨×™×œ',
                5: '×××™', 6: '×™×•× ×™', 7: '×™×•×œ×™', 8: '××•×’×•×¡×˜',
                9: '×¡×¤×˜××‘×¨', 10: '××•×§×˜×•×‘×¨', 11: '× ×•×‘××‘×¨', 12: '×“×¦××‘×¨'
            };

            const periodText = month ? `${monthNames[parseInt(month)]} ${year}` : `×©× ×ª ${year}`;
            const vehicleText = `×¨×›×‘ ${this.currentVehicle.number}`;
            
            // Calculate statistics
            const stats = this.calculateStats(this.allCalls);
            
            // Format hours
            const formatHours = (hours) => {
                const h = Math.floor(hours);
                const m = Math.round((hours - h) * 60);
                return `${h} ×©×¢×•×ª ${m} ×“×§×•×ª`;
            };

            // Create calls rows HTML
            const callsRows = this.allCalls.map((call, index) => {
                const callDate = new Date(call.call_date || call.created_at);
                const formattedDate = callDate.toLocaleDateString('he-IL', {
                    day: '2-digit',
                    month: '2-digit',
                    year: '2-digit'
                });
                
                const startTime = call.start_time ? call.start_time.substring(0, 5) : '-';
                const endTime = call.end_time ? call.end_time.substring(0, 5) : '-';
                const duration = call.duration_minutes ? `${call.duration_minutes} ×“×§'` : '-';
                
                const location = this.formatLocation(call);
                const alertCode = call.alert_code || '-';
                const medicalCode = call.medical_code || '-';

                return `
                    <tr style="${index % 2 === 0 ? 'background: #f9fafb;' : ''}">
                        <td style="padding: 6px; border: 1px solid #e5e7eb; text-align: center; font-weight: 600;">${index + 1}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${call.call_type || '-'}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${formattedDate}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${startTime}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${endTime}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${duration}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb; font-size: 9px;">${location}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${alertCode}</td>
                        <td style="padding: 6px; border: 1px solid #e5e7eb;">${medicalCode}</td>
                    </tr>
                `;
            }).join('');

            // Create temporary container
            const container = document.createElement('div');
            container.style.cssText = `
                position: absolute;
                left: -99999px;
                top: 0;
                width: 1000px;
                background: white;
                padding: 40px;
                font-family: 'Rubik', Arial, sans-serif;
                direction: rtl;
                color: #000;
            `;

            container.innerHTML = `
                <div style="text-align: center; background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px;">
                    <div style="font-size: 48px; margin-bottom: 10px;">ğŸï¸</div>
                    <h1 style="margin: 0 0 10px 0; font-size: 32px; font-weight: 700;">×“×•×— ×§×¨×™××•×ª - ××“×´×</h1>
                    <h2 style="margin: 0; font-size: 24px; font-weight: 500;">${periodText}</h2>
                    <h3 style="margin: 12px 0 0 0; font-size: 18px; font-weight: 400;">${vehicleText}</h3>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #dc2626; border-bottom: 3px solid #dc2626; padding-bottom: 10px; margin-bottom: 20px; font-size: 24px;">×¡×™×›×•× ×¡×˜×˜×™×¡×˜×™</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 16px;">
                        <tr style="background: #f3f4f6;">
                            <td style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 700; width: 60%;">×¡×”×´×› ×§×¨×™××•×ª:</td>
                            <td style="padding: 12px; border: 1px solid #e5e7eb; text-align: center; font-weight: 700; font-size: 18px;">${stats.totalCalls}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600;">×§×¨×™××•×ª ×“×—×•×¤×•×ª:</td>
                            <td style="padding: 12px; border: 1px solid #e5e7eb; text-align: center;">${stats.urgentCalls}</td>
                        </tr>
                        <tr style="background: #f3f4f6;">
                            <td style="padding: 12px; border: 1px solid #e5e7eb; font-weight: 600;">×§×¨×™××•×ª ××˜×´×Ÿ:</td>
                            <td style="padding: 12px; border: 1px solid #e5e7eb; text-align: center;">${stats.atanCalls}</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border: